"use strict";(self.webpackChunkxyz_chatboxapp_ce=self.webpackChunkxyz_chatboxapp_ce||[]).push([[653],{60653:(e,s,t)=>{t.r(s),t.d(s,{component:()=>T});var n=t(74848),a=t(99460),i=t(11507),l=t(69019),o=t(40054),r=t(17826),c=t(48324),d=t(63663),x=t(47765),h=t(63403),p=t(65311),m=t(16267),u=t(5055),g=t(30357),j=t(74192),v=t(44067),f=t(78332),w=t(34164),b=t(96540),y=t(34195),k=t(62938),z=(t(7824),t(14691),t(8427),t(96389)),A=(t(25780),t(51154),t(29907));const C=b.memo((function(e){const s="dark"===(0,A.l)(),t=s?"#7D90A1":"#EDF0F2",a=s?"#45525F":"#899AA9";return(0,n.jsxs)("svg",{width:34,height:33,fill:"none",...e,children:[(0,n.jsxs)("mask",{id:"prefix__a",maskUnits:"userSpaceOnUse",x:-.519,y:-.316,width:35,height:34,fill:"#000",children:[(0,n.jsx)("path",{fill:"#fff",d:"M-.519-.316h35v34h-35z"}),(0,n.jsx)("path",{d:"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z"})]}),(0,n.jsx)("path",{d:"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z",fill:t}),(0,n.jsx)("path",{d:"M26.148 2.684V.609v2.075zm5.333 5.333h2.075-2.075zm-5.333 18.37v2.075-2.074zm-16.11 0v-2.073c-.484 0-.952.168-1.324.476l1.323 1.598zm-5.19 4.297H2.776A2.074 2.074 0 006.17 32.28L4.85 30.684zm0-5.198h2.075c0-.691-.345-1.337-.92-1.722L4.85 25.486zM2.482 8.016H.407h2.074zm5.333-5.332V.609v2.075zm18.334 0v2.074c1.8 0 3.26 1.459 3.26 3.259h4.148A7.407 7.407 0 0026.149.608v2.075zm5.333 5.333h-2.074v13.037h4.149V8.017H31.48zm0 13.037h-2.074c0 1.8-1.459 3.26-3.259 3.26v4.148a7.408 7.408 0 007.408-7.408H31.48zm-5.333 5.334v-2.074h-16.11v4.148h16.11v-2.074zm-16.11 0L8.713 24.79l-5.188 4.296 1.323 1.598L6.17 32.28l5.189-4.296-1.323-1.597zm-5.19 4.296h2.075v-5.198H2.775v5.198h2.074zm0-5.198l1.156-1.722a3.254 3.254 0 01-1.448-2.71H.407c0 2.568 1.31 4.83 3.286 6.155l1.156-1.723zm-2.367-4.432h2.075V8.017H.407v13.037h2.074zm0-13.037h2.075a3.26 3.26 0 013.259-3.26V.61A7.407 7.407 0 00.406 8.016h2.074zm5.333-5.333v2.074h18.334V.609H7.814v2.075z",fill:a,mask:"url(#prefix__a)"}),(0,n.jsx)("circle",{cx:12.407,cy:14.386,r:1.63,fill:a,stroke:a,strokeWidth:.296}),(0,n.jsx)("circle",{cx:21.593,cy:14.386,r:1.63,fill:a,stroke:a,strokeWidth:.296})]})}));var I=t(31300),M=t(74791),S=t(93351),U=t(70266),N=t(8097),B=t(58641),_=t(88194),F=t(41258),E=t(90674),V=t(42446);const H=({selectedId:e,onSelect:s})=>{const{t}=(0,y.Bd)(),a=(0,N.L0)(),p=(0,V.j)((e=>e.widthFull)),{copilots:m}=(0,S.v)(),{copilots:u}=(0,S.x)(),v=(0,b.useMemo)((()=>m.length>=10?m:[...m,...m.length&&u.length?[void 0]:[],...u.filter((e=>!m.map((e=>e.id)).includes(e.id))).slice(0,10-m.length-1)]),[m,u]),f=(0,b.useMemo)((()=>v.length<m.length+u.length),[v.length,m.length,u.length]),w=(0,b.useRef)(null),[k,z]=(0,b.useState)({x:0,y:0});return v.length?(0,n.jsx)(i.a,{px:"md",children:(0,n.jsxs)(l.B,{gap:"xs",className:p?"w-full":"w-full max-w-4xl mx-auto",children:[(0,n.jsxs)(o.s,{align:"center",justify:"space-between",children:[(0,n.jsx)(r.E,{size:"xxs",c:"chatbox-tertiary",children:t("My Copilots").toUpperCase()}),!a&&(0,n.jsxs)(o.s,{align:"center",gap:"sm",children:[(0,n.jsx)(c.M,{variant:"transparent",color:"chatbox-tertiary",onClick:()=>{if(w.current){const e=w.current.clientWidth,s=Math.max(k.x-e,0);w.current.scrollTo({left:s,behavior:"smooth"}),z({x:s,y:0})}},children:(0,n.jsx)(M.n,{icon:g.A})}),(0,n.jsx)(c.M,{variant:"transparent",color:"chatbox-tertiary",onClick:()=>{if(w.current){const e=w.current.scrollWidth,s=w.current.clientWidth,t=Math.min(k.x+s,e-s);w.current.scrollTo({left:t,behavior:"smooth"}),z({x:t,y:0})}},children:(0,n.jsx)(M.n,{icon:j.A})})]})]}),(0,n.jsxs)(d.F,{type:a?"never":"scroll",mx:"-md",scrollbars:"x",offsetScrollbars:"x",viewportRef:w,onScrollPositionChange:z,className:"copilot-picker-scroll-area",children:[k.x>8&&!a&&(0,n.jsx)("div",{className:"absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-chatbox-background-primary to-transparent"}),!a&&(0,n.jsx)("div",{className:"absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-chatbox-background-primary to-transparent"}),(0,n.jsxs)(o.s,{wrap:"nowrap",gap:"xs",children:[(0,n.jsx)(x.$,{w:"xs"}),v.map((t=>t?(0,n.jsx)(L,{name:t.name,picUrl:t.picUrl,selected:e===t.id,onClick:()=>{s?.(t)}},t.id):(0,n.jsx)(h.c,{orientation:"vertical",my:"xs",mx:"xxs"},"divider"))),f&&(0,n.jsx)(L,{name:t("View All Copilots"),noAvatar:!0,selected:!1,onClick:()=>B.Q.navigate({to:"/copilots"})}),(0,n.jsx)(x.$,{w:"xs"})]})]})]})}):null},L=({name:e,picUrl:s,selected:t,onClick:a,noAvatar:i=!1})=>{const l=(0,N.L0)();return(0,n.jsxs)(o.s,{align:"center",gap:l?"xxs":"xs",py:"xs",px:l?"xs":"md",bd:t?"none":"1px solid var(--chatbox-border-primary)",bg:t?"var(--chatbox-background-brand-secondary)":"transparent",className:(0,w.A)("cursor-pointer shrink-0 shadow-[0px_2px_12px_0px_rgba(0,0,0,0.04)]",l?"rounded-full":"rounded-md"),onClick:a,children:[!i&&(0,n.jsx)(p.e,{src:s,color:"chatbox-brand",size:l?20:24,children:e.slice(0,1)}),(0,n.jsx)(r.E,{fw:"600",c:t?"chatbox-brand":"chatbox-primary",children:e})]})},T=function(){const{t:e}=(0,y.Bd)(),s=(0,N.L0)(),t=(0,V.j)((e=>e.newSessionState)),d=(0,V.j)((e=>e.setNewSessionState)),x=(0,V.j)((e=>e.addSessionKnowledgeBase)),h=(0,V.j)((e=>e.showCopilotsInNewSession)),p=(0,V.j)((e=>e.widthFull)),[g,j]=(0,b.useState)({id:"new",...(0,E.cY)()}),{providers:w}=(0,U.u)(),A=(0,b.useMemo)((()=>{if(g.settings?.provider&&g.settings?.modelId)return{provider:g.settings.provider,modelId:g.settings.modelId}}),[g.settings?.provider,g.settings?.modelId]),{copilots:T}=(0,S.v)(),{copilots:W}=(0,S.x)(),D=(0,b.useMemo)((()=>g?.copilotId),[g?.copilotId]),G=(0,b.useMemo)((()=>T.find((e=>e.id===D))||W.find((e=>e.id===D))),[T,W,D]);(0,b.useEffect)((()=>{j((e=>({...e,picUrl:G?.picUrl,name:G?.name||"Untitled",messages:G?[{id:(0,k.A)(),role:"system",contentParts:[{type:"text",text:G.prompt}]}]:(0,E.cY)().messages})))}),[G]);const K=(0,f.k)();(0,b.useEffect)((()=>{const{copilotId:e}=K.location.search;e&&j((s=>({...s,copilotId:e})))}),[K.location.search]);const P=(0,b.useCallback)((async({constructedMessage:e,needGenerating:s=!0})=>{const n=await(0,_.jw)({name:g.name,type:"chat",assistantAvatarKey:g.assistantAvatarKey,picUrl:g.picUrl,messages:g.messages,copilotId:g.copilotId,settings:g.settings});t.knowledgeBase&&(x(n.id,t.knowledgeBase),d({})),(0,F.yT)(n.id),(0,F.rj)(n.id,{newUserMsg:e,needGenerating:s})}),[g,x,t.knowledgeBase,d]),$=(0,b.useCallback)(((e,s)=>{j((t=>({...t,settings:{...t.settings||{},provider:e,modelId:s}})))}),[]),q=(0,b.useCallback)((async()=>{const e=await a.Ay.show("session-settings",{session:g,disableAutoSave:!0});return e&&j((s=>({...s,...e}))),!0}),[g]);return(0,n.jsx)(I.A,{title:"",children:(0,n.jsxs)("div",{className:"p-0 flex flex-col h-full",children:[(0,n.jsxs)(l.B,{align:"center",justify:"center",gap:"sm",flex:1,children:[(0,n.jsx)(C,{className:"h-8"}),(0,n.jsx)(r.E,{fw:"600",size:s?"sm":"md",children:e("What can I help you with today?")})]}),!w.length&&(0,n.jsx)(i.a,{px:"sm",children:(0,n.jsx)(m.t,{radius:"md",shadow:"none",withBorder:!0,py:"md",px:"sm",mb:"md",className:p?"w-full":"w-full max-w-4xl mx-auto",children:(0,n.jsxs)(l.B,{gap:"sm",children:[(0,n.jsxs)(l.B,{gap:"xxs",align:"center",children:[(0,n.jsx)(r.E,{fw:600,className:"text-center",children:e("Select and configure an AI model provider")}),(0,n.jsx)(r.E,{size:"xs",c:"chatbox-tertiary",className:"text-center",children:e("To start a conversation, you need to configure at least one AI model. Click the buttons below to get started.")})]}),(0,n.jsx)(o.s,{gap:"xs",justify:"center",align:"center",children:(0,n.jsx)(u.$,{size:"xs",variant:"light",h:32,miw:160,fw:600,flex:"0 1 auto",onClick:()=>{B.Q.navigate({to:s?"/settings/provider":"/settings/provider/chatbox-ai"})},children:e("Setup Provider")})})]})})}),(0,n.jsxs)(l.B,{gap:"sm",children:[g.copilotId?(0,n.jsx)(i.a,{px:"md",children:(0,n.jsxs)(l.B,{gap:"sm",className:p?"w-full":"w-full max-w-4xl mx-auto",children:[(0,n.jsxs)(o.s,{align:"center",gap:"sm",children:[(0,n.jsx)(L,{name:g.name,picUrl:g.picUrl,selected:!0}),(0,n.jsx)(c.M,{size:32,radius:16,c:"chatbox-tertiary",bg:"#F1F3F5",onClick:()=>j((e=>({...e,copilotId:void 0}))),children:(0,n.jsx)(M.n,{icon:v.A,size:24})})]}),(0,n.jsx)(r.E,{c:"chatbox-secondary",className:"line-clamp-5",children:g.messages[0]?.contentParts?.map((e=>"text"===e.type?e.text:"")).join("")||""})]})}):h&&(0,n.jsx)(H,{onSelect:e=>j((s=>({...s,copilotId:e?.id})))}),(0,n.jsx)(z.A,{sessionType:"chat",sessionId:"new",model:A,onSelectModel:$,onClickSessionSettings:q,onSubmit:P})]})]})})}},93351:(e,s,t)=>{t.d(s,{v:()=>d,x:()=>x});var n=t(97286),a=t(34843),i=t(84929),l=t(23342),o=t(12268),r=t(25203);const c=(0,i.tG)(o.Z.MyCopilots,[],o.A);function d(){const[e,s]=(0,a.fp)(c);return{copilots:e,addOrUpdate:e=>{s((s=>{let t=!1;const n=s.map((s=>s.id===e.id?(t=!0,e):s));return t||n.push(e),n}))},remove:e=>{s((s=>s.filter((s=>s.id!==e))))}}}function x(){const e=(0,r.ok)(),{data:s,...t}=(0,n.I)({queryKey:["remote-copilots",e],queryFn:()=>l.Gg(e),initialData:[],initialDataUpdatedAt:0,staleTime:36e5});return{copilots:s,...t}}}}]);
//# sourceMappingURL=653.d1688cf97e1d16345790.js.map