{"version":3,"file":"assets/js/653.d1688cf97e1d16345790.js","mappings":"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","sources":["webpack://xyz.chatboxapp.ce/./src/renderer/components/icons/HomepageIcon.tsx","webpack://xyz.chatboxapp.ce/./src/renderer/routes/index.tsx?9f8d","webpack://xyz.chatboxapp.ce/./src/renderer/hooks/useCopilots.ts"],"sourcesContent":["import { useComputedColorScheme, useMantineColorScheme } from '@mantine/core'\nimport * as React from 'react'\n\nfunction HomepageIcon(props: React.SVGProps<SVGSVGElement>) {\n  const colorScheme = useComputedColorScheme()\n  const isDark = colorScheme === 'dark'\n  const fillColor = isDark ? '#7D90A1' : '#EDF0F2'\n  const strokeColor = isDark ? '#45525F' : '#899AA9'\n\n  return (\n    <svg width={34} height={33} fill=\"none\" {...props}>\n      <mask id=\"prefix__a\" maskUnits=\"userSpaceOnUse\" x={-0.519} y={-0.316} width={35} height={34} fill=\"#000\">\n        <path fill=\"#fff\" d=\"M-.519-.316h35v34h-35z\" />\n        <path d=\"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z\" />\n      </mask>\n      <path\n        d=\"M26.148 2.684a5.333 5.333 0 015.333 5.333v13.037a5.334 5.334 0 01-5.333 5.334h-16.11l-5.19 4.296v-5.198a5.328 5.328 0 01-2.367-4.432V8.017a5.333 5.333 0 015.333-5.333h18.334z\"\n        fill={fillColor}\n      />\n      <path\n        d=\"M26.148 2.684V.609v2.075zm5.333 5.333h2.075-2.075zm-5.333 18.37v2.075-2.074zm-16.11 0v-2.073c-.484 0-.952.168-1.324.476l1.323 1.598zm-5.19 4.297H2.776A2.074 2.074 0 006.17 32.28L4.85 30.684zm0-5.198h2.075c0-.691-.345-1.337-.92-1.722L4.85 25.486zM2.482 8.016H.407h2.074zm5.333-5.332V.609v2.075zm18.334 0v2.074c1.8 0 3.26 1.459 3.26 3.259h4.148A7.407 7.407 0 0026.149.608v2.075zm5.333 5.333h-2.074v13.037h4.149V8.017H31.48zm0 13.037h-2.074c0 1.8-1.459 3.26-3.259 3.26v4.148a7.408 7.408 0 007.408-7.408H31.48zm-5.333 5.334v-2.074h-16.11v4.148h16.11v-2.074zm-16.11 0L8.713 24.79l-5.188 4.296 1.323 1.598L6.17 32.28l5.189-4.296-1.323-1.597zm-5.19 4.296h2.075v-5.198H2.775v5.198h2.074zm0-5.198l1.156-1.722a3.254 3.254 0 01-1.448-2.71H.407c0 2.568 1.31 4.83 3.286 6.155l1.156-1.723zm-2.367-4.432h2.075V8.017H.407v13.037h2.074zm0-13.037h2.075a3.26 3.26 0 013.259-3.26V.61A7.407 7.407 0 00.406 8.016h2.074zm5.333-5.333v2.074h18.334V.609H7.814v2.075z\"\n        fill={strokeColor}\n        mask=\"url(#prefix__a)\"\n      />\n      <circle cx={12.407} cy={14.386} r={1.63} fill={strokeColor} stroke={strokeColor} strokeWidth={0.296} />\n      <circle cx={21.593} cy={14.386} r={1.63} fill={strokeColor} stroke={strokeColor} strokeWidth={0.296} />\n    </svg>\n  )\n}\n\nconst MemoHomepageIcon = React.memo(HomepageIcon)\nexport default MemoHomepageIcon\n","import NiceModal from '@ebay/nice-modal-react';\nimport { ActionIcon, Avatar, Box, Button, Divider, Flex, Paper, ScrollArea, Space, Stack, Text } from '@mantine/core';\nimport { IconChevronLeft, IconChevronRight, IconX } from '@tabler/icons-react';\nimport { useRouterState } from '@tanstack/react-router';\nimport clsx from 'clsx';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport type { CopilotDetail, Session } from 'src/shared/types';\nimport { v4 as uuidv4 } from 'uuid';\nimport InputBox, { type InputBoxPayload } from '@/components/InputBox';\nimport HomepageIcon from '@/components/icons/HomepageIcon';\nimport Page from '@/components/Page';\nimport { ScalableIcon } from '@/components/ScalableIcon';\nimport { useMyCopilots, useRemoteCopilots } from '@/hooks/useCopilots';\nimport { useProviders } from '@/hooks/useProviders';\nimport { useIsSmallScreen } from '@/hooks/useScreenChange';\nimport { router } from '@/router';\nimport { createSession as createSessionStore } from '@/stores/chatStore';\nimport { submitNewUserMessage, switchCurrentSession } from '@/stores/sessionActions';\nimport { initEmptyChatSession } from '@/stores/sessionHelpers';\nimport { useUIStore } from '@/stores/uiStore';\nimport { Route } from \"D:/Downloads/chatbox-main/src/renderer/routes/index.tsx\";\nconst MAX_COPILOTS_TO_SHOW = 10;\nconst CopilotPicker = ({\n  selectedId,\n  onSelect\n}: {\n  selectedId?: string;\n  onSelect?(copilot?: CopilotDetail): void;\n}) => {\n  const {\n    t\n  } = useTranslation();\n  const isSmallScreen = useIsSmallScreen();\n  const widthFull = useUIStore(s => s.widthFull);\n  const {\n    copilots: myCopilots\n  } = useMyCopilots();\n  const {\n    copilots: remoteCopilots\n  } = useRemoteCopilots();\n  const copilots = useMemo(() => myCopilots.length >= MAX_COPILOTS_TO_SHOW ? myCopilots : [...myCopilots, ...(myCopilots.length && remoteCopilots.length ? [undefined] : []), ...remoteCopilots.filter(c => !myCopilots.map(mc => mc.id).includes(c.id)).slice(0, MAX_COPILOTS_TO_SHOW - myCopilots.length - 1)], [myCopilots, remoteCopilots]);\n  const showMoreButton = useMemo(() => copilots.length < myCopilots.length + remoteCopilots.length, [copilots.length, myCopilots.length, remoteCopilots.length]);\n  const viewportRef = useRef<HTMLDivElement>(null);\n  const [scrollPosition, onScrollPositionChange] = useState({\n    x: 0,\n    y: 0\n  });\n  if (!copilots.length) {\n    return null;\n  }\n  return <Box px=\"md\">\n      <Stack gap=\"xs\" className={widthFull ? 'w-full' : 'w-full max-w-4xl mx-auto'}>\n        <Flex align=\"center\" justify=\"space-between\">\n          <Text size=\"xxs\" c=\"chatbox-tertiary\">\n            {t('My Copilots').toUpperCase()}\n          </Text>\n\n          {!isSmallScreen && <Flex align=\"center\" gap=\"sm\">\n              <ActionIcon variant=\"transparent\" color=\"chatbox-tertiary\"\n          // onClick={() => setPage((p) => Math.max(p - 1, 0))}\n          onClick={() => {\n            if (viewportRef.current) {\n              // const scrollWidth = viewportRef.current.scrollWidth\n              const clientWidth = viewportRef.current.clientWidth;\n              const newScrollPosition = Math.max(scrollPosition.x - clientWidth, 0);\n              viewportRef.current.scrollTo({\n                left: newScrollPosition,\n                behavior: 'smooth'\n              });\n              onScrollPositionChange({\n                x: newScrollPosition,\n                y: 0\n              });\n            }\n          }}>\n                <ScalableIcon icon={IconChevronLeft} />\n              </ActionIcon>\n              <ActionIcon variant=\"transparent\" color=\"chatbox-tertiary\"\n          // onClick={() => setPage((p) => p + 1)}\n          onClick={() => {\n            if (viewportRef.current) {\n              const scrollWidth = viewportRef.current.scrollWidth;\n              const clientWidth = viewportRef.current.clientWidth;\n              const newScrollPosition = Math.min(scrollPosition.x + clientWidth, scrollWidth - clientWidth);\n              viewportRef.current.scrollTo({\n                left: newScrollPosition,\n                behavior: 'smooth'\n              });\n              onScrollPositionChange({\n                x: newScrollPosition,\n                y: 0\n              });\n            }\n          }}>\n                <ScalableIcon icon={IconChevronRight} />\n              </ActionIcon>\n            </Flex>}\n        </Flex>\n\n        <ScrollArea type={isSmallScreen ? 'never' : 'scroll'} mx=\"-md\" scrollbars=\"x\" offsetScrollbars=\"x\" viewportRef={viewportRef} onScrollPositionChange={onScrollPositionChange} className=\"copilot-picker-scroll-area\">\n          {scrollPosition.x > 8 && !isSmallScreen && <div className=\"absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-chatbox-background-primary to-transparent\"></div>}\n          {!isSmallScreen && <div className=\"absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-chatbox-background-primary to-transparent\"></div>}\n          <Flex wrap=\"nowrap\" gap=\"xs\">\n            <Space w=\"xs\" />\n            {copilots.map(copilot => copilot ? <CopilotItem key={copilot.id} name={copilot.name} picUrl={copilot.picUrl} selected={selectedId === copilot.id} onClick={() => {\n            onSelect?.(copilot);\n          }} /> : <Divider key=\"divider\" orientation=\"vertical\" my=\"xs\" mx=\"xxs\" />)}\n            {showMoreButton && <CopilotItem name={t('View All Copilots')} noAvatar={true} selected={false} onClick={() => router.navigate({\n            to: '/copilots'\n          })} />}\n            <Space w=\"xs\" />\n          </Flex>\n        </ScrollArea>\n      </Stack>\n    </Box>;\n};\nconst CopilotItem = ({\n  name,\n  picUrl,\n  selected,\n  onClick,\n  noAvatar = false\n}: {\n  name: string;\n  picUrl?: string;\n  selected?: boolean;\n  onClick?(): void;\n  noAvatar?: boolean;\n}) => {\n  const isSmallScreen = useIsSmallScreen();\n  return <Flex align=\"center\" gap={isSmallScreen ? 'xxs' : 'xs'} py=\"xs\" px={isSmallScreen ? 'xs' : 'md'} bd={selected ? 'none' : '1px solid var(--chatbox-border-primary)'} bg={selected ? 'var(--chatbox-background-brand-secondary)' : 'transparent'} className={clsx('cursor-pointer shrink-0 shadow-[0px_2px_12px_0px_rgba(0,0,0,0.04)]', isSmallScreen ? 'rounded-full' : 'rounded-md')} onClick={onClick}>\n      {!noAvatar && <Avatar src={picUrl} color=\"chatbox-brand\" size={isSmallScreen ? 20 : 24}>\n          {name.slice(0, 1)}\n        </Avatar>}\n      <Text fw=\"600\" c={selected ? 'chatbox-brand' : 'chatbox-primary'}>\n        {name}\n      </Text>\n    </Flex>;\n};\nconst SplitComponent = function Index() {\n  const {\n    t\n  } = useTranslation();\n  const isSmallScreen = useIsSmallScreen();\n  const newSessionState = useUIStore(s => s.newSessionState);\n  const setNewSessionState = useUIStore(s => s.setNewSessionState);\n  const addSessionKnowledgeBase = useUIStore(s => s.addSessionKnowledgeBase);\n  const showCopilotsInNewSession = useUIStore(s => s.showCopilotsInNewSession);\n  const widthFull = useUIStore(s => s.widthFull);\n  const [session, setSession] = useState<Session>({\n    id: 'new',\n    ...initEmptyChatSession()\n  });\n  const {\n    providers\n  } = useProviders();\n  const selectedModel = useMemo(() => {\n    if (session.settings?.provider && session.settings?.modelId) {\n      return {\n        provider: session.settings.provider,\n        modelId: session.settings.modelId\n      };\n    }\n  }, [session.settings?.provider, session.settings?.modelId]);\n  const {\n    copilots: myCopilots\n  } = useMyCopilots();\n  const {\n    copilots: remoteCopilots\n  } = useRemoteCopilots();\n  const selectedCopilotId = useMemo(() => session?.copilotId, [session?.copilotId]);\n  const selectedCopilot = useMemo(() => myCopilots.find(c => c.id === selectedCopilotId) || remoteCopilots.find(c => c.id === selectedCopilotId), [myCopilots, remoteCopilots, selectedCopilotId]);\n  useEffect(() => {\n    setSession(old => ({\n      ...old,\n      picUrl: selectedCopilot?.picUrl,\n      name: selectedCopilot?.name || 'Untitled',\n      messages: selectedCopilot ? [{\n        id: uuidv4(),\n        role: 'system',\n        contentParts: [{\n          type: 'text',\n          text: selectedCopilot.prompt\n        }]\n      }] : initEmptyChatSession().messages\n    }));\n  }, [selectedCopilot]);\n  const routerState = useRouterState();\n  useEffect(() => {\n    const {\n      copilotId\n    } = routerState.location.search;\n    if (copilotId) {\n      setSession(old => ({\n        ...old,\n        copilotId\n      }));\n    }\n  }, [routerState.location.search]);\n  const handleSubmit = useCallback(async ({\n    constructedMessage,\n    needGenerating = true\n  }: InputBoxPayload) => {\n    const newSession = await createSessionStore({\n      name: session.name,\n      type: 'chat',\n      assistantAvatarKey: session.assistantAvatarKey,\n      picUrl: session.picUrl,\n      messages: session.messages,\n      copilotId: session.copilotId,\n      settings: session.settings\n    });\n\n    // Transfer knowledge base from newSessionState to the actual session\n    if (newSessionState.knowledgeBase) {\n      addSessionKnowledgeBase(newSession.id, newSessionState.knowledgeBase);\n      // Clear newSessionState after transfer\n      setNewSessionState({});\n    }\n    switchCurrentSession(newSession.id);\n    void submitNewUserMessage(newSession.id, {\n      newUserMsg: constructedMessage,\n      needGenerating\n    });\n  }, [session, addSessionKnowledgeBase, newSessionState.knowledgeBase, setNewSessionState]);\n  const onSelectModel = useCallback((p: string, m: string) => {\n    setSession(old => ({\n      ...old,\n      settings: {\n        ...(old.settings || {}),\n        provider: p,\n        modelId: m\n      }\n    }));\n  }, []);\n  const onClickSessionSettings = useCallback(async () => {\n    const res: Session = await NiceModal.show('session-settings', {\n      session,\n      disableAutoSave: true\n    });\n    if (res) {\n      setSession(old => ({\n        ...old,\n        ...res\n      }));\n    }\n    return true;\n  }, [session]);\n  return <Page title=\"\">\n      <div className=\"p-0 flex flex-col h-full\">\n        <Stack align=\"center\" justify=\"center\" gap=\"sm\" flex={1}>\n          <HomepageIcon className=\"h-8\" />\n          <Text fw=\"600\" size={isSmallScreen ? 'sm' : 'md'}>\n            {t('What can I help you with today?')}\n          </Text>\n        </Stack>\n\n        {!providers.length && <Box px=\"sm\">\n            <Paper radius=\"md\" shadow=\"none\" withBorder py=\"md\" px=\"sm\" mb=\"md\" className={widthFull ? 'w-full' : 'w-full max-w-4xl mx-auto'}>\n              <Stack gap=\"sm\">\n                <Stack gap=\"xxs\" align=\"center\">\n                  <Text fw={600} className=\"text-center\">\n                    {t('Select and configure an AI model provider')}\n                  </Text>\n\n                  <Text size=\"xs\" c=\"chatbox-tertiary\" className=\"text-center\">\n                    {t('To start a conversation, you need to configure at least one AI model. Click the buttons below to get started.')}\n                  </Text>\n                </Stack>\n\n                <Flex gap=\"xs\" justify=\"center\" align=\"center\">\n                  <Button size=\"xs\" variant=\"light\" h={32} miw={160} fw={600} flex=\"0 1 auto\" onClick={() => {\n                router.navigate({\n                  to: isSmallScreen ? '/settings/provider' : '/settings/provider/chatbox-ai'\n                });\n              }}>\n                    {t('Setup Provider')}\n                  </Button>\n                </Flex>\n              </Stack>\n            </Paper>\n          </Box>}\n\n        <Stack gap=\"sm\">\n          {session.copilotId ? <Box px=\"md\">\n              <Stack gap=\"sm\" className={widthFull ? 'w-full' : 'w-full max-w-4xl mx-auto'}>\n                <Flex align=\"center\" gap=\"sm\">\n                  <CopilotItem name={session.name} picUrl={session.picUrl} selected />\n                  <ActionIcon size={32} radius={16} c=\"chatbox-tertiary\" bg=\"#F1F3F5\" onClick={() => setSession(old => ({\n                ...old,\n                copilotId: undefined\n              }))}>\n                    <ScalableIcon icon={IconX} size={24} />\n                  </ActionIcon>\n                </Flex>\n\n                <Text c=\"chatbox-secondary\" className=\"line-clamp-5\">\n                  {session.messages[0]?.contentParts?.map(part => part.type === 'text' ? part.text : '').join('') || ''}\n                </Text>\n              </Stack>\n            </Box> : showCopilotsInNewSession && <CopilotPicker onSelect={copilot => setSession(old => ({\n          ...old,\n          copilotId: copilot?.id\n        }))} />}\n\n          <InputBox sessionType=\"chat\" sessionId=\"new\" model={selectedModel}\n        // fullWidth\n        onSelectModel={onSelectModel} onClickSessionSettings={onClickSessionSettings} onSubmit={handleSubmit} />\n        </Stack>\n      </div>\n    </Page>;\n};\nexport { SplitComponent as component };","import { useQuery } from '@tanstack/react-query'\nimport { useAtom } from 'jotai'\nimport { atomWithStorage } from 'jotai/utils'\nimport type { CopilotDetail } from 'src/shared/types'\nimport * as remote from '@/packages/remote'\nimport storage, { StorageKey } from '@/storage'\nimport { useLanguage } from '@/stores/settingsStore'\n\nconst myCopilotsAtom = atomWithStorage<CopilotDetail[]>(StorageKey.MyCopilots, [], storage)\n\nexport function useMyCopilots() {\n  const [copilots, setCopilots] = useAtom(myCopilotsAtom)\n\n  const addOrUpdate = (target: CopilotDetail) => {\n    setCopilots((copilots) => {\n      let found = false\n      const newCopilots = copilots.map((c) => {\n        if (c.id === target.id) {\n          found = true\n          return target\n        }\n        return c\n      })\n      if (!found) {\n        newCopilots.push(target)\n      }\n      return newCopilots\n    })\n  }\n\n  const remove = (id: string) => {\n    setCopilots((copilots) => copilots.filter((c) => c.id !== id))\n  }\n\n  return {\n    copilots,\n    addOrUpdate,\n    remove,\n  }\n}\n\nexport function useRemoteCopilots() {\n  const language = useLanguage()\n  const { data: copilots, ...others } = useQuery({\n    queryKey: ['remote-copilots', language],\n    queryFn: () => remote.listCopilots(language),\n    initialData: [],\n    initialDataUpdatedAt: 0,\n    staleTime: 3600 * 1000,\n  })\n  return { copilots, ...others }\n}\n"],"names":["props","isDark","fillColor","strokeColor","width","height","fill","id","maskUnits","x","y","d","mask","cx","cy","r","stroke","strokeWidth","CopilotPicker","selectedId","onSelect","isSmallScreen","widthFull","s","copilots","myCopilots","remoteCopilots","useMemo","length","undefined","filter","c","map","mc","includes","slice","showMoreButton","viewportRef","useRef","scrollPosition","onScrollPositionChange","useState","Box","px","Stack","gap","className","Flex","align","justify","Text","size","t","toUpperCase","ActionIcon","variant","color","onClick","current","clientWidth","newScrollPosition","Math","max","scrollTo","left","behavior","ScalableIcon","icon","IconChevronLeft","scrollWidth","min","IconChevronRight","ScrollArea","type","mx","scrollbars","offsetScrollbars","wrap","Space","w","copilot","CopilotItem","name","picUrl","selected","Divider","orientation","my","noAvatar","router","navigate","to","py","bd","bg","clsx","Avatar","src","fw","SplitComponent","newSessionState","setNewSessionState","addSessionKnowledgeBase","showCopilotsInNewSession","session","setSession","providers","useProviders","u","selectedModel","settings","provider","modelId","selectedCopilotId","copilotId","selectedCopilot","find","useEffect","old","messages","role","contentParts","text","prompt","routerState","useRouterState","location","search","handleSubmit","useCallback","async","constructedMessage","needGenerating","newSession","assistantAvatarKey","knowledgeBase","newUserMsg","onSelectModel","p","m","onClickSessionSettings","res","disableAutoSave","Page","title","flex","Paper","radius","shadow","withBorder","mb","Button","h","miw","IconX","part","join","InputBox","sessionType","sessionId","model","onSubmit","myCopilotsAtom","MyCopilots","useMyCopilots","setCopilots","addOrUpdate","target","found","newCopilots","push","remove","useRemoteCopilots","language","data","others","queryKey","queryFn","initialData","initialDataUpdatedAt","staleTime"],"sourceRoot":""}